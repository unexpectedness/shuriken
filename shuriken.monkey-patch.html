<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>shuriken.monkey-patch documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Shuriken</span> <span class="project-version">0.14.52</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clojure</span></div></div></li><li class="depth-2"><a href="clojure.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>shuriken</span></div></div></li><li class="depth-2 branch"><a href="shuriken.associative.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>associative</span></div></a></li><li class="depth-2"><a href="shuriken.byte-buddy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>byte-buddy</span></div></a></li><li class="depth-3"><a href="shuriken.byte-buddy.dsl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dsl</span></div></a></li><li class="depth-2 branch"><a href="shuriken.core.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="shuriken.debug.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>debug</span></div></a></li><li class="depth-2 branch"><a href="shuriken.dev.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dev</span></div></a></li><li class="depth-2 branch"><a href="shuriken.exception.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>exception</span></div></a></li><li class="depth-2 branch"><a href="shuriken.iterator.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>iterator</span></div></a></li><li class="depth-2 branch"><a href="shuriken.lazy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lazy</span></div></a></li><li class="depth-2 branch"><a href="shuriken.let.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>let</span></div></a></li><li class="depth-2 branch"><a href="shuriken.macro.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>macro</span></div></a></li><li class="depth-2 branch"><a href="shuriken.meta.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>meta</span></div></a></li><li class="depth-2 branch current"><a href="shuriken.monkey-patch.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>monkey-patch</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>monkey-patches</span></div></div></li><li class="depth-3 branch"><a href="shuriken.monkey-patches.as-macro.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>as-macro</span></div></a></li><li class="depth-3 branch"><a href="shuriken.monkey-patches.fn-source.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fn-source</span></div></a></li><li class="depth-3 branch"><a href="shuriken.monkey-patches.function-name.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>function-name</span></div></a></li><li class="depth-3"><a href="shuriken.monkey-patches.syntax-quote.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>syntax-quote</span></div></a></li><li class="depth-2 branch"><a href="shuriken.namespace.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>namespace</span></div></a></li><li class="depth-2 branch"><a href="shuriken.reflection.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>reflection</span></div></a></li><li class="depth-2 branch"><a href="shuriken.sequential.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sequential</span></div></a></li><li class="depth-2 branch"><a href="shuriken.source.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>source</span></div></a></li><li class="depth-2 branch"><a href="shuriken.spec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>spec</span></div></a></li><li class="depth-2 branch"><a href="shuriken.string.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>string</span></div></a></li><li class="depth-2"><a href="shuriken.tree.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tree</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="shuriken.monkey-patch.html#var-define-again"><div class="inner"><span>define-again</span></div></a></li><li class="depth-1"><a href="shuriken.monkey-patch.html#var-java-patch"><div class="inner"><span>java-patch</span></div></a></li><li class="depth-1"><a href="shuriken.monkey-patch.html#var-monkey-patch"><div class="inner"><span>monkey-patch</span></div></a></li><li class="depth-1"><a href="shuriken.monkey-patch.html#var-once"><div class="inner"><span>once</span></div></a></li><li class="depth-1"><a href="shuriken.monkey-patch.html#var-primitive-types"><div class="inner"><span>primitive-types</span></div></a></li><li class="depth-1"><a href="shuriken.monkey-patch.html#var-refresh-once"><div class="inner"><span>refresh-once</span></div></a></li><li class="depth-1"><a href="shuriken.monkey-patch.html#var-require-from-dependent-namespaces"><div class="inner"><span>require-from-dependent-namespaces</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">shuriken.monkey-patch</h1><div class="doc"><div class="markdown"><h3><a href="#tools-to-monkey-patch-clojure-and-java-code" id="tools-to-monkey-patch-clojure-and-java-code"></a>Tools to monkey-patch Clojure and Java code</h3>
</div></div><div class="public anchor" id="var-define-again"><h3>define-again</h3><div class="usage"><code>(define-again namespaced-sym)</code></div><div class="doc"><div class="markdown"><p>Refreshes a var by evaluating its source. Preserves metadata.</p>
</div></div><div class="src-link"><a href="https://github.com/unexpectedness/shuriken/">view source</a></div></div><div class="public anchor" id="var-java-patch"><h3>java-patch</h3><h4 class="type">macro</h4><div class="usage"><code>(java-patch &amp; args)</code></div><div class="doc"><div class="markdown"><p>Applies a monkey-patch to a java method.</p>
<p><code>mode</code> can be either <code>:replace</code>, <code>:before</code> or <code>:after</code>. <code>body</code> can be javassist pseudo-java (a string) or clojure code. In the latter case, <code>args</code> must be specified before <code>body</code> so as to intercept the method’s parameters. If <code>:after</code> is used <code>args</code> will include the method’s return value. If the method is an instance method, <code>args</code> will also include the instance it is called on (<code>this</code>).</p>
<p><code>args</code>: <code>[this? return-value? &amp; method-args]</code></p>
<pre><code class="language-clojure">(java-patch [clojure.lang.LispReader "read"
             [java.io.PushbackReader "boolean" Object "boolean" Object]]
  :replace
  [reader eof-is-error eof-value _is-recursive opts]
  (clojure.tools.reader/read
    (merge {:eofthrow eof-is-error
            :eof eof-value}
           opts)
    reader))

;; or

(java-patch [clojure.lang.LispReader$SyntaxQuoteReader "syntaxQuote"
             [Object]]
  :after
  "{
     $_ = clojure.lang.RT.list(
       clojure.lang.Symbol.intern("clojure.core", "from-syntax-quote"),
       $_
     );
  }")
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/unexpectedness/shuriken/">view source</a></div></div><div class="public anchor" id="var-monkey-patch"><h3>monkey-patch</h3><h4 class="type">macro</h4><div class="usage"><code>(monkey-patch name target args &amp; body)</code></div><div class="doc"><div class="markdown"><pre><code class="language-clojure">(monkey-patch perfid-incer clojure.core/+ [original &amp; args]
  (inc (apply original args)))

(+ 1 2)
=&gt; 4
</code></pre>
<p>Supports reload. Name and target can be vars or symbols. Name can also be a keyword.</p>
</div></div><div class="src-link"><a href="https://github.com/unexpectedness/shuriken/">view source</a></div></div><div class="public anchor" id="var-once"><h3>once</h3><h4 class="type">macro</h4><div class="usage"><code>(once name &amp; body)</code></div><div class="doc"><div class="markdown"><p>Ensures <code>body</code> is executed only once with respect to <code>name</code>. If <code>name</code> is a symbol or a keyword without a namespace, it will be prefixed with the value of <code>*ns*</code>.</p>
<pre><code class="language-clojure">(once 'foo (println "bar"))
; prints bar

(once 'foo (println "bar"))
; prints nothing
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/unexpectedness/shuriken/">view source</a></div></div><div class="public anchor" id="var-primitive-types"><h3>primitive-types</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/unexpectedness/shuriken/">view source</a></div></div><div class="public anchor" id="var-refresh-once"><h3>refresh-once</h3><div class="usage"><code>(refresh-once name)</code></div><div class="doc"><div class="markdown"><p>Reset <code>once</code> statements by name. Next time one is called, the associated code will be evaluated. If <code>name</code> is a symbol or a keyword without a namespace, it will be prefixed with <code>*ns*</code>.</p>
<pre><code class="language-clojure">(once 'foo (println "bar"))
; prints bar

(refresh-once 'foo)
(once 'foo (println "bar"))
; prints bar
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/unexpectedness/shuriken/">view source</a></div></div><div class="public anchor" id="var-require-from-dependent-namespaces"><h3>require-from-dependent-namespaces</h3><div class="usage"><code>(require-from-dependent-namespaces requirement)</code></div><div class="doc"><div class="markdown"><p>Requires a namespace from any namespace that has required it. <code>requirement</code> can be anything <code>require</code> accepts.</p>
<pre><code class="language-clojure">(require-from-dependent-namespaces
  '[clojure.core :refer [custom-fn]])
</code></pre>
</div></div><div class="src-link"><a href="https://github.com/unexpectedness/shuriken/">view source</a></div></div></div></body></html>